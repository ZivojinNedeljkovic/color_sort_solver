(()=>{const e=e=>e[e.length-1],t=e=>4===e.length&&r(e),n=(n,r)=>n.length>0&&r.length<4&&(e(n)===e(r)||0===r.length)&&!t(n);function r(e){for(const t of e)if(t!==e[0])return!1;return!0}function o(e,t){if(n(e,t)&&((e,t)=>{return!(r(e)&&(0===t.length||(n=t,4-n.length<e.length)));var n})(e,t)){[e,t]=[[...e],[...t]];do{t.push(e.pop())}while(n(e,t));return{emptiedBottle:e,filledBottle:t}}}const s=(e,t)=>{if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0};var h=class{constructor(e,t){this.key=e,this.parent=t,this.children=[]}_hasUniqueKeyInBranch(e,t){return!t||!e(this.key,t.key)&&this._hasUniqueKeyInBranch(e,t.parent)}hasUniqueKeyInBranch(e){return this._hasUniqueKeyInBranch(e,this.parent)}getBranchKeys(){const e=[];let t=this;for(;t;)e.push(t.key),t=t.parent;return e.reverse()}};function i(e,t){if(e.length!=e.length)return!1;for(let n=0;n<e.length;n++)if(!s(e[n],t[n]))return!1;return!0}var l=class{constructor(e,t){this.onFindSolution=t,this.bestMoveCount=Number.MAX_SAFE_INTEGER,this.search(new h(e,void 0))}removeLastAddedNodeFromParent(e){e.parent?.children.pop()}search(e,n=0){if(n>=this.bestMoveCount||!e.hasUniqueKeyInBranch(i))return void this.removeLastAddedNodeFromParent(e);const r=e.key;if(function(e){for(const n of e)if(!t(n)&&0!==n.length)return!1;return!0}(r))return this.onFindSolution(e.getBranchKeys()),void(this.bestMoveCount=n);r.forEach(((t,s)=>{r.forEach(((i,l)=>{if(s===l)return;const u=o(t,i);if(!u)return;const{emptiedBottle:a,filledBottle:c}=u,f=[...r];f[s]=a,f[l]=c;const d=new h(f,e);e.children.push(d),this.search(d,n+1)}))})),0===e.children.length&&this.removeLastAddedNodeFromParent(e)}};onmessage=function(e){console.log("hello from worker");const t=JSON.parse(e.data);let n=!1;new l(t,(e=>{n=!0,postMessage(e)})),n||postMessage([])}})();
//# sourceMappingURL=worker.js.map
